# Enumeration - Juice Shop 

### Wappalyzer Fingerprinting

- Use **Wappalyzer** browser extension to identify tech stack.
    
- Example results from Juice Shop:
    
    - **CMS**: WordPress
        
    - **Frameworks**: AngularJS, Zone.js
        
    - **Languages**: PHP (may be a false positive), Node.js
        
    - **OS**: Debian
        
    - **Server**: Apache HTTP Server
        
    - **Database**: MySQL
        
    - **CDNs**: Cloudflare, cdnjs
        

---

## Directory Enumeration

### Using ZAP:

- Save your ZAP session.
    
- Right-click the Juice Shop URL and **add it to a new context** (helps in scoping).
    
- Use built-in **fuzzing** with wordlists (e.g., `directory-list-lowercase-2.3-medium.txt`).
    
- Look for endpoints like `/ftp`, `/video`, `/promotion` (can be slow).
    

### Alternative Tool: feroxbuster (Recommended)

- **Faster**, more configurable than DirBuster/ZAP
    
- Install:
    
    ```bash
    curl -sL https://raw.githubusercontent.com/epi052/feroxbuster/main/install-nix.sh | bash -s $HOME/.local/bin
    ```
    
- Run:
    
    ```bash
    feroxbuster -u http://ubuntu-server:8002/ \
                -t 10 -L 5 \
                -w /usr/share/seclists/Discovery/Web-Content/directory-list-lowercase-2.3-medium.txt \
                -o feroxbuster.output
    ```
	
	- The [feroxbuster.output](feroxbuster.output.md) file to review.

- More options: [https://epi052.github.io/feroxbuster-docs/docs/configuration/limit-connections/](https://epi052.github.io/feroxbuster-docs/docs/configuration/limit-connections/)
	- Read the details from the link above because it's important to understand what does the `-t 10 -L 5` mean in this context.
    

#### Output Interpretation

- `200 OK`: interesting, often valid paths
    
- `500`: possible injection point (Juice Shop crashes on some)
    
- `403/401`: possible restricted area
    
- `301`: redirection (still followable)
    

#### If Juice Shop Crashes

- A `500` from `/api`, `/redirect`, etc. means Juice Shop may have crashed
    
- Restart the container using `run.sh`
    

---

## Sending feroxbuster Results to ZAP

Example of feroxbuster output file
1. Extract URLs:

    ```bash
    grep "^200" feroxbuster.output | tr -s " " | cut -d " " -f 6
    ```
     - `grep "^200"` → get lines starting with `200`
    
	- `tr -s " "`

		- `tr` stands for **translate or squeeze**.
    
		- `-s " "` means **"squeeze repeated spaces into a single space"**.
    
	- `cut -d " " -f 6`
	
		- `cut` extracts fields from each line.
		    
		- `-d " "` says **"use space as the delimiter"**.
		    
		- `-f 6` means **"show me the 6th field"** (after splitting the line by spaces).
		
2. Export as a variable:
    
    ```bash
    export urls=$(grep "^200" feroxbuster.output | tr -s " " | cut -d " " -f 6)
    ```
    
3. Send each to ZAP via curl:
    
    ```bash
    for u in $urls; do
      curl $u --proxy http://localhost:8080
    done
    ```
    
4. Check ZAP's **History Tab** to confirm imports (look for User-Agent = `curl`)
    

---

## Bonus: Using ZAP Spider & AJAX Spider

- **Traditional Spider**: Crawls linked pages
    
- **AJAX Spider**: Uses a headless browser to render JS-heavy content (required for modern apps)
    
- AJAX Spider results are marked in **red** in ZAP’s Sites tree.