# Additional API Testing

#### API Manipulation: `/api/Products/19`

- Testing `/api/Products/19` endpoint revealed that changing the product `id` in the URL results in a new object being returned.
    
- **Testing PUT method**:
    
    - Changing the GET request method to PUT and sending the product data in the request body to update the product didn't work unless specific conditions were met.
        
    
    **Example Product Response:**
    
    ```json
    {  
      "status" : "success",  
      "data" : {  
        "id" : 19,  
        "name" : "OWASP Juice Shop Hoodie",  
        "description" : "Mr. Robot-style apparel. But in black. And with logo.",  
        "price" : 49.99,  
        "deluxePrice" : 49.99,  
        "image" : "fan_hoodie.jpg",  
        "createdAt" : "2025-05-07T17:18:21.994Z",  
        "updatedAt" : "2025-05-07T17:18:21.994Z",  
        "deletedAt" : null  
      }  
    }
    ```
    
    - Attempts to modify the payload by removing the `status` key or removing the `data` block were unsuccessful.
        
    - However, **adding the `Content-Type: application/json` header** allowed the PUT request to go through, and the product was successfully modified.
        
    
    **Modified Product Example**:
    
    ```json
    {  
      "id" : 19,  
      "name" : "Zaki edition - OWASP Juice Shop Hoodie",  
      "description" : "Mr. Robot-style apparel. But in black. And with logo.",  
      "price" : 49.99,  
      "deluxePrice" : 49.99,  
      "image" : "fan_hoodie.jpg",  
      "createdAt" : "2025-05-07T17:18:21.994Z",  
      "updatedAt" : "2025-05-07T17:18:21.994Z",  
      "deletedAt" : null  
    }
    ```
    
    - **Free Products**: By setting the product price to `0`, it was possible to purchase any quantity of the product for free.
        
    
	![Pasted image 20250507205833](attachments/Pasted%20image%2020250507205833.png)
    

#### Creating New Products via POST

- By modifying the endpoint from `/api/Products/:id` to `/api/Products/`, a **POST request** successfully created new products.
    
    **New Product Creation Payload**:
    
    ```json
    {  
      "name" : "Zaki new product",  
      "description" : "This product is created by Zaki",  
      "price" : 190,  
      "deluxePrice" : 10,  
      "image" : "<img src=x onerror=alert(1)/>",  
      "createdAt" : "2025-05-07T17:18:21.994Z",  
      "updatedAt" : "2025-05-07T17:18:21.994Z",  
      "deletedAt" : null  
    }
    ```
    
    - While XSS payload injection into the `name`, `description`, and `image` fields was attempted, none of these fields accepted XSS payloads.
        

#### MongoDB Vulnerability

- In the process of testing MongoDB-based vulnerabilities, a critical vulnerability was noted related to **updating multiple product reviews simultaneously**.
    
- **Vulnerability**:
    - This vulnerability highlights the potential for bulk updates that can be destructive, especially when multiple product reviews can be modified at once.
        
- **Solution**:
    - The vulnerability stresses the importance of taking **backups** and ensuring database modifications are well-guarded against accidental or malicious alterations.
        
    You can find more details on this vulnerability and the solution in the [companion guide](https://pwning.owasp-juice.shop/companion-guide/latest/part2/injection.html#_update_multiple_product_reviews_at_the_same_time) and the [solutions section](https://pwning.owasp-juice.shop/companion-guide/latest/appendix/solutions.html#_update_multiple_product_reviews_at_the_same_time).
    

---

> **Note**: During this course, we didn't test all components of the application. In a real penetration test (PT), every component that can be modified should be thoroughly tested for potential vulnerabilities.
