# Login & Authentication


#### SQL Injection – Login Bypass

Tested a classic SQL injection payload in the login form:

- **Email/Username:** `' or 1=1; -- `
    
- **Password:** anything (ignored)
    

Note: Include a space before and after the `--` comment marker to properly terminate the SQL query.

This successfully bypassed authentication and logged in. 
This confirms a critical finding/vulnerability: **Authentication Bypass via SQL Injection**.

#### Privilege Escalation via Role Tampering

After creating a regular user, the API response included:

```json
"role": "customer"
```

This reveals that the user role is being exposed (and likely controlled) on the client side.

Next step:

1. Created another user using the registration endpoint.
    
2. Manually modified the request body to set `"role": "admin"`.
    

This worked. The new user was created with admin privileges.

This is a case of **Privilege Escalation via Insecure Role Assignment**. The backend does not properly restrict or validate role values during user registration.

![Pasted image 20250505004655](attachments/Pasted%20image%2020250505004655.png) 

---
#### Authorization Header Check – `/rest/user/whoami`

Removed the `Authorization` header to test how the endpoint behaves.

- The response still returned user info.
- This endpoint relies solely on session cookies for identifying the user.
    
The course instructor classifies this as **Insufficient Authorization**, but I disagree in this context.
- The endpoint returns only data related to the currently authenticated user.
- If not logged in → returns an empty object.
- If logged in → returns that user's email and ID.
- There is no role-based exposure, user enumeration, or access to unauthorized data.
    
This is standard session-based behavior and does not appear to be a true authorization flaw.
