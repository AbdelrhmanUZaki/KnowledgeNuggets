**Cross-site Request Forgery (CSRF)**  
CSRF is a web vulnerability that tricks users into performing unintended actions on a website where they are authenticated, bypassing the same-origin policy.  

**Impact**: Attackers can manipulate user accounts (e.g., change email, password, or transfer funds), potentially gaining full control if the user has privileged access.  

**Conditions for Attack**:  
1. A valuable action (e.g., changing account details).  
2. Cookie-based session handling with no additional session validation.  
3. Predictable request parameters (no unknown values).  

**How It Works**:  
An attacker crafts a malicious webpage (e.g., with a hidden form) that submits a request to the vulnerable site. If the victim is logged in, their browser includes session cookies, and the site processes the request as legitimate. Example: A form changing the user’s email to an attacker-controlled address.  

**Delivery**:  
Similar to reflected XSS—hosted on attacker-controlled sites, spread via links, or embedded in popular sites. GET-based CSRF can use simple URLs (e.g., `<img src="vulnerable-site.com/change?email=attacker@evil.com">`).  

**Defenses**:  
1. **CSRF Tokens**: Unique, unpredictable tokens required in requests.  
2. **SameSite Cookies**: Restrict cookies from cross-site requests (Lax by default in Chrome).  
3. **Referer Validation**: Verify request origin (less reliable).  

**Bypassing Defenses**: Possible by exploiting weak token validation, lax SameSite settings, or flawed Referer checks.

---

**XSS vs CSRF**

**XSS (Cross-Site Scripting)**: Allows attackers to inject and execute malicious JavaScript in a victim's browser, enabling arbitrary actions and data theft.

**CSRF (Cross-Site Request Forgery)**: Tricks users into performing unintended actions on a site where they’re authenticated, without retrieving responses.

**Key Differences**:
- **Impact**: XSS is more severe, allowing attackers to perform any user action and steal data (two-way). CSRF is limited to specific actions and is one-way (no response retrieval).
- **Scope**: XSS exploits any vulnerable function; CSRF often targets unprotected or overlooked actions.

**Can CSRF Tokens Prevent XSS?**
- **Yes, in some cases**: For **reflected XSS**, if a function requires a valid CSRF token and the server rejects invalid tokens, exploitation is blocked since the attacker can’t forge a valid cross-site request.
- **Limitations**:
  - If another site function lacks CSRF protection, reflected XSS can be exploited normally.
  - Exploitable XSS (reflected or stored) can bypass CSRF tokens by requesting a valid token from the site and using it to perform protected actions.
  - **Stored XSS** is unaffected by CSRF tokens, as the malicious script executes directly on the page when visited, within the site’s context.

---


---

References
- https://portswigger.net/web-security/csrf